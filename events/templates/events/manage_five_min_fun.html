
<!-- events/templates/events/manage_five_min_fun.html -->
{% extends "base.html" %}

{% block title %}Manage 5-Min Fun | Mindset Playroom{% endblock %}

{% block content %}
    <h1>Manage {{ five_min_fun.name }}</h1>
    {% if messages %}
        <ul>
            {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    
        {% csrf_token %}
        {{ form.name.label_tag }} {{ form.name }}

        Photo:
        <button type="button" id="uploadWidget">Upload Photo</button>
        {{ form.photo }}

        Audio:
        <button type="button" id="uploadAudioWidget">Upload Audio</button>
        {{ form.audio }}

        {{ form.instructions.label_tag }} {{ form.instructions }}

        {{ form.tags.label_tag }} {{ form.tags }}

        {{ form.age_groups.label_tag }} {{ form.age_groups }}

        {{ form.format_type.label_tag }} {{ form.format_type }}

        {{ form.place.label_tag }} {{ form.place }}

        {{ form.super_powers.label_tag }} {{ form.super_powers }}

        {{ form.routines.label_tag }} {{ form.routines }}

        <button type="submit">Update</button>
    
    Back to Dashboard
    <script>
        // Cloudinary Upload Widget Integration
        document.addEventListener('DOMContentLoaded', function() {
            const photoWidget = cloudinary.createUploadWidget({
                cloudName: 'dvrbpkbr7',  // Replace with your Cloudinary cloud name
                uploadPreset: 'playroom_upload',  // Replace with your unsigned upload preset name
                sources: ['local', 'url', 'camera'],
                multiple: false,
                resourceType: 'image'
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    const uploadedUrl = result.info.secure_url;
                    document.getElementById('id_photo').value = uploadedUrl;
                    console.log("Uploaded photo URL:", uploadedUrl);
                }
            });

            document.getElementById('uploadWidget').addEventListener('click', function() {
                photoWidget.open();
            }, false);

            const audioWidget = cloudinary.createUploadWidget({
                cloudName: 'dvrbpkbr7',  // Replace with your Cloudinary cloud name
                uploadPreset: 'playroom_upload',  // Replace with your unsigned upload preset name
                sources: ['local', 'url'],
                multiple: false,
                resourceType: 'video'  // Audio files are uploaded as 'video' resource type in Cloudinary
            }, (error, result) => {
                if (!error && result && result.event === "success") {
                    const uploadedUrl = result.info.secure_url;
                    document.getElementById('id_audio').value = uploadedUrl;
                    console.log("Uploaded audio URL:", uploadedUrl);
                }
            });

            document.getElementById('uploadAudioWidget').addEventListener('click', function() {
                audioWidget.open();
            }, false);
        });
    </script>
{% endblock %}